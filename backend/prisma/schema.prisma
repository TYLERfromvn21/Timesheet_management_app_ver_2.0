// backend/prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- 1. Model cho Auth (Giữ nguyên quan hệ User - Department) ---
model User {
  id            String      @id @default(cuid())
  username      String      @unique
  password      String
  role          UserRole
  departmentId  String
  department    Department  @relation(fields: [departmentId], references: [id])
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  deletedAt     DateTime?

  @@index([departmentId])
  @@index([role])
}

model Department {
  id        String    @id @default(cuid())
  code      String    @unique
  name      String
  users     User[]    // Một phòng ban có nhiều user
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?
}

// --- 2. Model cho Dashboard (Phiên bản đơn giản, không relation) ---
model JobCode {
  id              String   @id @default(uuid())
  department      String   // Lưu mã phòng ban (VD: IT) trực tiếp
  jobCode         String   @unique
  taskDescription String
  createdAt       DateTime @default(now())
}

model Task {
  id              String   @id @default(uuid())
  department      String
  jobCode         String
  taskDescription String
  startTime       DateTime
  endTime         DateTime
  date            DateTime // Ngày làm việc
  createdAt       DateTime @default(now())
}

// --- 3. Enums ---
enum UserRole {
  ADMIN_TOTAL
  ADMIN_DEPT
  USER
}